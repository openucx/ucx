#
# Copyright (c) NVIDIA CORPORATION & AFFILIATES, 2021. ALL RIGHTS RESERVED.
#
# See file LICENSE for terms.
#

get_filename_component(prefix "${CMAKE_CURRENT_LIST_DIR}/../../.." ABSOLUTE)
set(exec_prefix "@exec_prefix@")

set(_ucx_targets_defined "")
set(_ucx_targets_not_defined "")
set(_ucx_expected_targets "")
foreach(_ucx_expected_target IN ITEMS ucx::ucs ucx::uct ucx::ucp)
  list(APPEND _ucx_expected_targets "${_ucx_expected_target}")
  if(TARGET "${_ucx_expected_target}")
    list(APPEND _ucx_targets_defined "${_ucx_expected_target}")
  else()
    list(APPEND _ucx_targets_not_defined "${_ucx_expected_target}")
  endif()
endforeach()
unset(_ucx_expected_target)
if(NOT _ucx_targets_not_defined)
  unset(_ucx_targets_defined)
  unset(_ucx_targets_not_defined)
  unset(_ucx_expected_targets)
  unset(CMAKE_IMPORT_FILE_VERSION)
  return()
endif()
if(NOT _ucx_targets_defined STREQUAL "")
  string(REPLACE ";" ", " _ucx_targets_defined_text "${_ucx_targets_defined}")
  string(REPLACE ";" ", " _ucx_targets_not_defined_text "${_ucx_targets_not_defined}")
  message(FATAL_ERROR "Some (but not all) ucx targets were already defined.\nTargets Defined: ${_ucx_targets_defined_text}\nTargets not yet defined: ${_ucx_targets_not_defined_text}\n")
endif()
unset(_ucx_targets_defined)
unset(_ucx_targets_not_defined)
unset(_ucx_expected_targets)

add_library(ucx::ucs SHARED IMPORTED)

set_target_properties(ucx::ucs PROPERTIES
  IMPORTED_LOCATION "@libdir@/libucs.so"
  INTERFACE_INCLUDE_DIRECTORIES "@includedir@"
)

add_library(ucx::ucp SHARED IMPORTED)

set_target_properties(ucx::ucp PROPERTIES
  IMPORTED_LOCATION "@libdir@/libucp.so"
  INTERFACE_INCLUDE_DIRECTORIES "@includedir@"
)

add_library(ucx::uct SHARED IMPORTED)

set_target_properties(ucx::uct PROPERTIES
  IMPORTED_LOCATION "@libdir@/libuct.so"
  INTERFACE_INCLUDE_DIRECTORIES "@includedir@"
)
