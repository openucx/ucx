# See https://aka.ms/yaml

trigger: none

resources:
  pipelines:
  - pipeline: myTest
    source: 'UCX snapshot'
    trigger: true

stages:
  - stage: Rebase
    jobs:
      - job: rebase
        pool:
          name: MLNX
          demands:
          - ucx_docker -equals yes
        displayName: rebase on openucx/ucx@master
        steps:
          - bash: |
              set -eEx
              git remote set-url origin git@github.com:Mellanox/ucx.git
              git checkout avildema-patch-1
              git remote add upstream https://github.com/openucx/ucx.git
              git fetch upstream
              git rebase upstream/master
              git push origin HEAD --force
